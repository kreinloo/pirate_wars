/*

	pw_scoreboard.js

*/

var util = require("util");

Scoreboard = function (server) {

	this.server = server;
	
	this.requestHandler = function (socket) {
		var db = server.getDB();
		var scores = [];
		db.getStmt("SCOREBOARD").all(function(err, rows) {
			for (var i = 0; i < rows.length; i++) {
				var row = rows[i];
				scores.push({
					username : row.username,
					wins : row.wins,
					losses : row.losses,
					ratio : row.ratio
				});
			}
			server.emitScoreboard(scores, socket);
			if (DEBUG.SERVER)
				util.debug(SCOREBOARD.DATA + " " + JSON.stringify(scores));
		});
	};

};
